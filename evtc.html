<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>EV Torque Calculator Platinum</title>
    <link rel="icon" type="image/x-icon" href="media/favicon.ico">
    <link href="css/bootstrap.css" rel="stylesheet"/>
    <script type="module" src="js/custom/torqueCalculator.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<header class="d-flex flex-wrap justify-content-center align-items-center py-3 mb-4 border-bottom p-3">
    <a href="index.html"
       class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
        <img src="media/evtc-logopng.png" alt="Logo" width="64" height="64" class="me-2"/>
        <span class="fs-4">EV Torque Calculator Platinum</span>
    </a>
    <ul class="nav nav-pills">
        <li class="nav-item">
            <a href="index.html" class="nav-link active bg-danger"><i class="fa-solid fa-xmark"></i></a>
        </li>
    </ul>
</header>

<div class="container">
    <div class="row g-4">
        <!-- Left Column: Inputs -->
        <div class="col-md-6">
            <form id="evForm" class="needs-validation" novalidate>
                <h4 class="mb-3">EV Torque Calculator</h4>

                <!-- Custom Curve Toggle -->
                <div class="form-check form-switch mb-3">
                    <input class="form-check-input" type="checkbox" id="customCurveToggle" />
                    <label class="form-check-label" for="customCurveToggle">Use Custom Curve Sliders</label>
                </div>

                <!-- Preset Selector -->
                <div id="presetSelectorSection" class="mb-3">
                    <label for="engineType" class="form-label">Electric Motor Type</label>
                    <select id="engineType" class="form-select" required>
                        <option value="" disabled selected>Select electric motor type</option>
                        <option value="raw">Raw Output (flat max torque, then power-limited falloff)</option>
                        <option value="fastRamp">Fast Ramp-up, Gentle Fall-off</option>
                        <option value="slowRampStrongFalloff">Slow Ramp-up, Strong Fall-off</option>
                        <option value="flatTop">Flat Torque Top</option>
                        <option value="" disabled>---------------------</option>
                        <option value="nissanLeaf">Nissan Leaf ahh</option>
                        <option value="gmEV1">GM EV1</option>
                        <option value="vwID4">VW ID.4</option>
                        <option value="enyaqRS">Škoda Enyaq vRS</option>
                        <option value="porscheTaycan">Porsche Taycan</option>
                        <option value="teslaModelS">Tesla Model S</option>
                        <option value="" disabled>---------------------</option>
                        <option value="eSkateboardSlither">E-Skateboard</option>
                        <option value="dumpsterDive">Dumpster Dive</option>
                        <option value="lawnmower">Lawnmower</option>
                        <option value="nyanMotor">Nyan Cat</option>
                        <option value="brokenToaster">Broken Toaster</option>
                        <option value="jesusTookTheMotor">Jesus Took The Motor</option>
                    </select>
                    <div class="invalid-feedback">Please select an electric motor type.</div>
                </div>

                <!-- Custom Sliders (hidden by default) -->
                <div id="customSlidersSection" style="display:none;">
                    <label class="form-label mt-3">Ramp-up Duration (% of max RPM)</label>
                    <input type="range" min="0" max="100" value="20" id="rampUpSlider" class="form-range" />
                    <div><small><span id="rampUpValue">20%</span></small></div>

                    <label class="form-label mt-3">Plateau Length (% of max RPM)</label>
                    <input type="range" min="0" max="100" value="50" id="plateauSlider" class="form-range" />
                    <div><small><span id="plateauValue">50%</span></small></div>

                    <label class="form-label mt-3">Fall-off Start (% of max RPM)</label>
                    <input type="range" min="0" max="100" value="70" id="falloffStartSlider" class="form-range" />
                    <div><small><span id="falloffStartValue">70%</span></small></div>

                    <label class="form-label mt-3">Fall-off Steepness (1-10)</label>
                    <input type="range" min="1" max="10" value="5" id="falloffSteepnessSlider" class="form-range" />
                    <div><small><span id="falloffSteepnessValue">5</span></small></div>
                </div>

                <!-- Max Torque -->
                <div class="mb-3 mt-4">
                    <label for="maxTorque" class="form-label">Max Torque (Nm)</label>
                    <input type="number" step="0.1" min="0" class="form-control" id="maxTorque" value="300" required/>
                    <div class="invalid-feedback">Please enter max torque (positive number).</div>
                </div>

                <!-- Max Power -->
                <div class="mb-3">
                    <label for="maxPower" class="form-label">Max Power (hp)</label>
                    <input type="number" step="0.1" min="0" class="form-control" id="maxPower" value="200" required/>
                    <div class="invalid-feedback">Please enter max power (positive number).</div>
                </div>

                <!-- Torque Precision -->
                <div class="mb-3">
                    <label for="precisionSlider" class="form-label">Torque Precision (RPM step)</label>
                    <input
                            type="range"
                            class="form-range"
                            min="10"
                            max="5000"
                            step="10"
                            id="precisionSlider"
                            value="500"
                    />
                    <div>Current Precision: <span id="precisionValue">500</span> RPM</div>
                </div>

                <!-- Max RPM -->
                <div class="mb-3">
                    <label for="maxRpm" class="form-label">Max RPM</label>
                    <input type="number" step="1" min="1" class="form-control" id="maxRpm" value="16000" required/>
                    <div class="invalid-feedback">Please enter max RPM (positive integer).</div>
                </div>

                <!-- export to .txt -->
                <div class="form-check form-switch mb-4">
                    <input class="form-check-input" type="checkbox" id="exportTxt"/>
                    <label class="form-check-label" for="exportTxt">Export output to
                        <code>torque_output.txt</code></label>
                </div>

                <button class="btn btn-primary w-100" type="submit">Calculate Torque Table</button>
            </form>
        </div>

        <!-- Right Column: Output -->
        <div class="col-md-6">
            <h4>Output</h4>
            <pre id="output" aria-live="polite" aria-atomic="true" class="output-area"
                 style="background:#121212; color:#eee; padding:1rem; border-radius:.5rem; max-height: 70vh; overflow-y:auto; font-family: monospace;"></pre>
        </div>
    </div>
    <canvas id="torqueChart" style="max-width: 100%; height: 300px;"></canvas>
</div>

<footer class="py-3 my-4">
    <ul class="nav justify-content-center border-bottom pb-3 mb-3">
        <li class="nav-item"><a href="index.html" class="nav-link px-2 text-body-secondary">Home</a></li>
    </ul>
    <p class="text-center text-body-secondary">© 2025 FIR3xd</p></footer>
</body>
</html>